<htmlform formUuid="c9f43a39-c1ad-400c-bc77-fc2e37608dce"
          formName="PDC eMastercard"
          formEncounterType="cb6be652-c5ee-447d-9d94-1100ffb26aa8"
          formVersion="1.0">

    <macros>

        aliveNotOnART=8037
        aliveOnART=8038
        died=1742
        birthWeight=5916
        hivSuspected=1062
        motherStatus=8036
        gestationalAge=8912
        siteOfBirth=3528
        hospital=2070
        healthCenter=3566
        home=3527
        childFeeding=1151
        breastfedPredominately=1150
        weaned=1152
        expressedBreastMilk=1173
        infantFormula=5254
        breastfedExclusively=5526
        mixedFeeding=6046
        <macro key="perinatalInfection" value="5c1f2ade-4224-46c3-99f5-7236aab13f13"/>
        <macro key="reasonForReferral" value="98b17e13-659f-41e7-8459-b370fdbffe0f"/>
        <macro key="lowBirthWeight" value="6575742a-977f-11e1-8993-905e29aff6c1"/>
        <macro key="prematureBirth" value="f541084c-84c7-48a6-b502-d9ddbb3bb3b9"/>
        <macro key="cnsInfection" value="657169d4-977f-11e1-8993-905e29aff6c1"/>
        <macro key="hydrocephalus" value="26071668-6ad4-4d30-b661-a7a07cece1ac"/>
        <macro key="downsSyndrome" value="722824d7-8392-4d62-a8c7-4b329f5094cd"/>
        <macro key="cleftLip" value="735a9376-abde-4538-8f28-c73f998e5e47"/>
        <macro key="otherDevelopmentalDelay" value="07a093b4-989e-4128-b015-38961791a714"/>
        <macro key="severeMalnutrition" value="a94e5963-f6b1-4c91-b676-48dfb370a1f8"/>
        <macro key="ageOfPrimaryCareTaker" value="fa7a921c-bd5f-4d5d-8e4f-4dc5060e37b7"/>
        <macro key="occupation" value="6558df36-977f-11e1-8993-905e29aff6c1"/>
        <macro key="maritalStatus" value="6557571a-977f-11e1-8993-905e29aff6c1"/>
        <macro key="married" value="656c71b8-977f-11e1-8993-905e29aff6c1"/>
        <macro key="single" value="656416a8-977f-11e1-8993-905e29aff6c1"/>
        <macro key="divorced" value="65575b98-977f-11e1-8993-905e29aff6c1"/>
        <macro key="widowed" value="65575cb0-977f-11e1-8993-905e29aff6c1"/>
        <macro key="levelOfEduction" value="655b226e-977f-11e1-8993-905e29aff6c1"/>
        <macro key="breastFeeding" value="657a289e-977f-11e1-8993-905e29aff6c1"/>
        <macro key="cupFeeding" value="4f3e0805-3059-4226-abcd-6100cddd9543" />
        <!--<macro key="primary" value=""/>
        <macro key="secondary" value=""/>
        <macro key="tertiary" value=""/>-->
        <macro key="numberOfChildren" value="656056da-977f-11e1-8993-905e29aff6c1"/>
        <macro key="transport" value="654b41b4-977f-11e1-8993-905e29aff6c1"/>
        <macro key="walk" value="654b42b8-977f-11e1-8993-905e29aff6c1"/>
        <macro key="motorBike" value="6567061a-977f-11e1-8993-905e29aff6c1"/>
        <macro key="miniBus" value="654b44c0-977f-11e1-8993-905e29aff6c1"/>
        <macro key="car" value="654b45c4-977f-11e1-8993-905e29aff6c1"/>
        <macro key="bicycle" value="654b43c6-977f-11e1-8993-905e29aff6c1"/>

        yesAnswer=1065
        noAnswer=1066
        unknown=1067
        positive=703
        negative=664
        diagnosisSet=8445
        chronicCareDiagnosis=3683
        diagnosisDate=6774
        asthmaDx=5
        asthmaFamilyHistory=8426
        copdDx=3716
        copdFamilyHistory=8427
        hivStatus=3753
        reactive=1228
        nonReactive=1229
        hivTestDate=1837
        artStartDate=2516
        tbStatus=7459
        smearPos=2185
        smearNeg=2186
        eptb=1547
        tbYear=8453
        patientPhone=1426
        symptom=1293
        dryCough=2128
        duration=2161
        ageAtOnset=8428
        exposureGroup=8546
        exposureAns=8495
        exposureDate=8545
        tbContact=2133
        secondHandSmoke=8443
        occupationalExposure=8430
        guardianName=1824
        cookingLocation=8404
        indoor=2437
        outdoor=2438
        smokingHistory=1551
        inPast=1548
        lastTimeSmoking=8432
        guardianPhone=2616
        occupation=1304
        relationToPatient=1328
        agreesToFollowup=2552
        chwName=8431
    </macros>

    <span style="display:none">
        <encounterProvider default="16576" /><!-- Set provider to a default as not used -->
        <span id="patientBirthdate"><lookup expression="patient.birthdate"/></span>
    </span>
    <div>
        <h4 style="font-style: italic;">
            <b>PDC Patient Card</b>
            <b style="padding-left:50px;">Pediatric Development Clinic</b>
            <span style="padding-left:50px;">Version 1</span>

            <span style="padding-left:50px;">
                <b style="padding-right:10px;">
                    <encounterLocation id="mastercardLocation" />
                    <span style="padding-left:20px;">
                        Date: <encounterDate />
                    </span>
                </b>
            </span>

            <span style="padding-left:50px;">
                <b style="padding-right:10px;">PDC Reg no: </b>
                <b>
                    <lookup complexExpression="#foreach( $id in $patientIdentifiers.get(&quot;PDC Identifier&quot;) ) $!id #end" />
                </b>
            </span>
        </h4>
        <table class="data-entry-table">
            <tr style="border: none;">
                <td style="vertical-align:top;">
                    <h5>Patient / Guardian Details</h5>
                    <table>
                        <tr>
                            <td>Patient Name</td>
                            <td>
                                <lookup expression="patient.personName" />
                            </td>
                        </tr>
                        <tr>
                            <td>Sex, DOB</td>
                            <td>
                                <span class="left-cell">
                                    <lookup expression="patient.gender" />
                                </span>
                                <span class="right-cell">
                                    <lookup expression="patient.birthdate" />
                                    (Age: <lookup expression="patient.age"/>)
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <td>Physical Address</td>
                            <td><!-- style="height:60px;"-->
                                <lookup complexExpression="#foreach( $addr in $patient.addresses) $!addr.getAddress1() $!addr.getCityVillage() $!addr.getStateProvince() $!addr.getCountyDistrict(), #end" />
                            </td>
                        </tr>
                        <tr>
                            <td>Patient Phone</td>
                            <td><obs conceptId="$patientPhone" size="10"/></td>
                        </tr>
                        <tr>
                            <td>Guardian Name</td>
                            <td>
                                <obs id="guardianNameField" conceptId="$guardianName" size="40"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Guardian Phone</td>
                            <td>
                                <obs conceptId="$guardianPhone" size="10"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Guardian relation to patient</td>
                            <td>
                                <obs conceptId="$relationToPatient" size="10" />
                            </td>
                        </tr>
                        <tr>
                            <td>Agrees to FUP</td>
                            <td>
                                <obs conceptId="$agreesToFollowup" style="radio" answerLabels="N,Y" answerConceptIds="$noAnswer,$yesAnswer" />
                            </td>
                        </tr>
                        <tr>
                            <td>CHW Name</td>
                            <td>
                                <lookup complexExpression="#foreach(${relationship} in ${relationshipList})
				#if( $velocityCount == 1 )
				          #if(${relationship.relationshipType.uuid} == 'eb567be2-fda1-4746-9d51-833de8a7e81f')
				                ${relationship.personA.personName}
				          #end
				#else
					  #if(${relationship.relationshipType.uuid} == 'eb567be2-fda1-4746-9d51-833de8a7e81f')
						&#44; ${relationship.personA.personName}
				          #end
				#end
                              #end "/>
                            </td>
                        </tr>
                    </table>
                </td>
                <td style="vertical-align:top;">
                    <h5>Patient Overview</h5>
                    <table>
                        <tr>
                            <th style="vertical-align:top;" align="left" rowspan="3">Referral Information</th>
                            <td>Patient Referred by:</td>
                            <th style="vertical-align:top;" align="left" rowspan="3">Social History</th>
                            <td>

                                <obs conceptId="$ageOfPrimaryCareTaker" labelText="Age Of Primary Care Taker" />
                            </td>
                            <td>
                                <!-- Marital Status -->
                                <obs conceptId="$maritalStatus" answerConceptIds="$married,$single,$divorced,$widowed"
                                     labelText="Marital Status"
                                     answerLabels="Married,Single,Divorced,Widowed"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Cadre:</td>
                            <td>Occupation</td>
                            <td>Level of Education</td>

                            <!--<td><obs conceptId="$artStartDate" labelText="ART Start Date" /></td>
                            <td class="nowrap">
                                <obs conceptId="$tbStatus" labelText="TB" answerConceptIds="$smearPos,$smearNeg,$eptb,$unknown"
                                     answerLabels="smear pos,smear neg,EPTB,never had TB"/></td>-->
                        </tr>
                        <tr>

                           <td>
                               Phone Number
                           </td>
                            <td class="nowrap">
                                <obs conceptId="$numberOfChildren"
                                     labelText="Total number of children or dependants less than 18 years in household (including child enrolled in PDC)" />
                            </td>
                            <td>
                                <!-- Transport -->
                                <obs conceptId="$transport" answerConceptIds="$walk,$motorBike,$miniBus,$bicycle,$car"  labelText="Transport"
                                     answerLabels="Walk,Motor bike,Minibus,Bicycle,Car "/>
                            </td>
                        </tr>
                        <tr>
                            <th style="vertical-align:top;" align="left" rowspan="10">History of Present<br/> Illness <br/></th>
                            <td>
                                <obs conceptId="$gestationalAge" labelText="Gestational Age" showUnits="true" />
                            </td>
                            <td />
                            <!-- Birth Weight -->
                            <td class="nowrap">
                                <obs conceptId="$birthWeight" showUnits="true" labelText=" Birth Weight" />
                            </td>
                            <td>
                                <obs conceptId="$siteOfBirth" labelText="Site Of Birth" answerConceptIds="$hospital,$healthCenter,$home"
                                     answerLabels="Hospital,Health Center,Home" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <obs conceptId="$perinatalInfection" style="radio" answerLabels="Yes,No,Unknown"
                                     answerConceptIds="$yesAnswer,$noAnswer,$unknown" labelText="Perinatal Infection"/>
                            </td>
                            <td />
                            <td>
                                <obs conceptId="$breastFeeding"  answerLabels="Yes,No"
                                     answerConceptIds="$yesAnswer,$noAnswer" labelText="Breast Feeding"/>
                            </td>
                            <td>
                                <obs conceptId="$cupFeeding"  answerLabels="Yes,No"
                                     answerConceptIds="$yesAnswer,$noAnswer" labelText="Cup-Feeding"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <span>Child Feeding (Select all that apply)</span>
                                <br /><br />
                                <obs conceptId="$childFeeding" style="checkbox" answerConceptId="$weaned" answerLabel="Weaned" />
                                <br />
                                <obs conceptId="$childFeeding" style="checkbox" answerConceptId="$expressedBreastMilk" answerLabel="Expressed Breast Milk" />
                                <br />
                                <obs conceptId="$childFeeding" style="checkbox" answerConceptId="$infantFormula" answerLabel="Infant Formula" />
                                <br />
                                <obs conceptId="$childFeeding" style="checkbox" answerConceptId="$breastfedExclusively" answerLabel="Breastfed Exclusively" />
                                <br />
                                <obs conceptId="$childFeeding" style="checkbox" answerConceptId="$mixedFeeding" answerLabel="Mixed Feeding" />
                            </td>
                            <td/>
                            <td>
                                <span>Reason for referral: (Select all that apply)</span>
                                <br /><br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$lowBirthWeight" answerLabel="Low Birth Weight" />
                                <br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$prematureBirth" answerLabel="Premature Birth" />
                                <br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$cnsInfection" answerLabel="CNS infection" />
                                <br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$hydrocephalus" answerLabel="Hydrocephalus" />
                                <br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$downsSyndrome" answerLabel="Downs Syndrome (suspected or confirmed)" />
                                <br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$cleftLip" answerLabel="Cleft Lip or Palate" />
                                <br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$otherDevelopmentalDelay" answerLabel="Other Developmental Delay, Suspected Neuromuscular Disease, and Suspected Genetic Syndromes" />
                                <br />
                                <obs conceptId="$reasonForReferral" style="checkbox" answerConceptId="$severeMalnutrition" answerLabel="Severe Malnutrition requiring  Club Foot, hospitalization (infant less than 12 months)" />
                            </td>
                            <td>
                                <!-- Mother Status -->
                                <obs conceptId="$motherStatus" answerConceptIds="$aliveNotOnART,$aliveOnART,$hivSuspected"
                                     answerLabels="No&amp;nbsp;ART,On&amp;nbsp;ART, Unk" labelText="HIV status of mother" />
                            </td>
                        </tr>
                        <tr>
                            <td>Child Medication</td>
                        </tr>
                        <tr>
                            <th style="vertical-align:top;" align="left">Outcome</th>
                            <td colspan="4">
                                <b>
                                    <lookup expression="fn.currentProgramWorkflowStatus(16).state.concept.name" />
                                    (<lookup expression="fn.currentProgramWorkflowStatus(16).startDate" />)
                                </b>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <ifMode mode="VIEW" include="false">
            <div id="buttons" style="margin-top:10px;">
                <button class="submitButton confirm" onclick="submitHtmlForm()">
                    <uimessage code="uicommons.save"/>
                    <i class="icon-spinner icon-spin icon-2x" style="display: none; margin-left: 10px;"></i>
                </button>
            </div>
        </ifMode>
    </div>
</htmlform>
